# containerM ğŸ³

`containerM`ëŠ” Go ì–¸ì–´ë¡œ êµ¬í˜„í•œ Linux í™˜ê²½ ê²½ëŸ‰ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì…ë‹ˆë‹¤.
ì»¨í…Œì´ë„ˆì˜ í•µì‹¬ ê°œë…ì¸ **ë„¤ì„ìŠ¤í˜ì´ìŠ¤, cgroups, pivot_root, ê°€ìƒ ë„¤íŠ¸ì›Œí¬** ë“±ì„ ì§ì ‘ ë‹¤ë£¨ë©°, 
ì»¨í…Œì´ë„ˆê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ë¥¼ í•™ìŠµí•˜ê³  ì‹¤í—˜í•˜ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- âœ… UTS, PID, Mount, Network, User ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê²©ë¦¬
- âœ… `pivot_root`ë¥¼ í†µí•œ ë£¨íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œ ë¶„ë¦¬
- âœ… `/proc`, `/dev`, `/sys` ë§ˆìš´íŠ¸
- âœ… `veth` ê¸°ë°˜ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ + ë¸Œë¦¿ì§€ ì„¤ì •
- âœ… `/dev/null`, `/dev/zero`, `/dev/random` ë“± ê¸°ë³¸ ì¥ì¹˜ ë…¸ë“œ í¬í•¨
- âœ… ë¦¬ì†ŒìŠ¤ ì •ë¦¬ë¥¼ ìœ„í•œ ì•ˆì „í•œ ì¢…ë£Œ ì²˜ë¦¬ (`defer`, trap ë“±)

---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
containerM/
â”œâ”€â”€ main.go # í”„ë¡œê·¸ë¨ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”œâ”€â”€ go.mod # Go ëª¨ë“ˆ ì„¤ì •
â”œâ”€â”€ cmd/
â”‚    â””â”€â”€ run.go # run, child ëª…ë ¹ ì²˜ë¦¬
â”œâ”€â”€ container/
â”‚    â””â”€â”€ process.go # ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰, ì´ˆê¸°í™”
â”œâ”€â”€ fs/
â”‚    â””â”€â”€ pivot.go # pivot_root ë° íŒŒì¼ ì‹œìŠ¤í…œ ë§ˆìš´íŠ¸
â”œâ”€â”€ namespace/
â”‚    â”œâ”€â”€ uts.go # hostname ì„¤ì •
â”‚    â”œâ”€â”€ pid.go # (í™•ì¥ ê°€ëŠ¥)
â”‚    â”œâ”€â”€ mount.go # /proc, /sys ë§ˆìš´íŠ¸
â”‚    â”œâ”€â”€ net.go # (í™•ì¥ ê°€ëŠ¥)
â”‚    â””â”€â”€ dev.go # /dev ë§ˆìš´íŠ¸ ë° ë””ë°”ì´ìŠ¤ ìƒì„±
â”œâ”€â”€ scripts/
â”‚    â”œâ”€â”€ host_setup.sh # í˜¸ìŠ¤íŠ¸ ì¸¡ veth/bridge ì„¤ì •
â”‚    â””â”€â”€ container_setup.sh # ì»¨í…Œì´ë„ˆ ì¸¡ eth0 ì„¤ì •
â”œâ”€â”€ utils/
â”‚    â””â”€â”€ must.go # ì—ëŸ¬ í•¸ë“¤ í—¬í¼
â””â”€â”€ README.md
```

---

## âš™ï¸ ë¹Œë“œ ë° ì‹¤í–‰ ë°©ë²•

### 0. í…ŒìŠ¤íŠ¸ í™˜ê²½
* ubuntu 24.04.2
  
### 1. ë¹Œë“œ

```bash
go build -o containerM .
```

### 2. ì»¨í…Œì´ë„ˆ ë£¨íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œ ì¤€ë¹„
```bash
mkdir -p /tmp/ubuntufs
debootstrap --variant=minbase focal /tmp/ubuntufs http://archive.ubuntu.com/ubuntu # ë˜ëŠ” busybox í™˜ê²½ êµ¬ì„±
```

### 3. ì‹¤í–‰ ì˜ˆì‹œ
```bash
sudo ./containerM run /bin/bash
```
